(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60367c63"],{"04ed":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"100px","status-icon":""}},[a("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[a("el-input",{on:{blur:function(t){return e.trim("name")}},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"碳积分",prop:"integral"},on:{blur:function(t){return e.trim("integral")}}},[a("el-input",{model:{value:e.formData.integral,callback:function(t){e.$set(e.formData,"integral",t)},expression:"formData.integral"}})],1),a("el-form-item",{attrs:{label:"商品描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",clearable:"",maxlength:"300","show-word-limit":"",resize:"none",rows:"5"},on:{blur:function(t){return e.trim("description")}},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1),a("el-form-item",{attrs:{label:"图片",required:""}},[a("el-upload",{staticClass:"upload-container",attrs:{action:"/api/upload/merchandise",name:"merchandise","show-file-list":!1,"before-upload":e.beforeUpload,"on-success":e.success,"on-error":e.error,accept:e.accept}},[e.imageUrl?a("div",{staticClass:"avatar-container"},[a("custom-image",{attrs:{url:e.imageUrl},on:{load:function(t){return e.load(e.imageUrl)}}})],1):a("div",{staticClass:"content-container"},[a("i",{staticClass:"el-icon-plus"})])])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v("提交")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)},n=[],r=(a("a4d3"),a("e01a"),a("b0c0"),a("a9e3"),a("e49c")),s=a("9a2e"),o=a("11f8"),l={name:"MerchandiseForm",mixins:[r["a"],s["a"]],props:{id:{type:Number,default:-1},name:{type:String,default:""},integral:{type:String,default:""},description:{type:String,default:""},path:{type:String,default:""}},data:function(){return{formData:{name:"",description:"",integral:""},rules:{name:[{required:!0,message:"不能为空",whitespace:!0}],integral:[{required:!0,message:"不能为空"},{pattern:/(^[1-9][0-9]{0,4}(\.[0-9]{1,2})?$)|(^0?\.[0-9]{1,2}$)/,message:"不符合要求"}],description:[{required:!0,message:"不能为空",whitespace:!0}]},loading:!1,maxUploadCount:1}},components:{CustomImage:o["a"]},watch:{id:function(){this.init()}},computed:{imageUrl:function(){return this.fileList[0].imageUrl}},created:function(){this.init()},methods:{init:function(){-1!==this.id?(this.formData.name=this.name,this.formData.description=this.description,this.formData.integral=this.integral,this.fileList=[{path:this.path,imageUrl:this.path}]):this.fileList=[{imageUrl:"",path:""}]},cancel:function(){this.loading=!1},submit:function(){var e=this;""!==this.fileList[0].path?this.$refs.form.validate((function(t){t&&(e.loading=!0,e.$emit("submit",{name:e.formData.name,description:e.formData.description,integral:parseFloat(e.formData.integral),path:e.fileList[0].path}))})):this.$message.error("请选择一张图片！")},reset:function(){this.init(),-1===this.id&&this.$refs.form.resetFields()}}},c=l,m=(a("beb7"),a("2877")),u=Object(m["a"])(c,i,n,!1,null,"7d646cf0",null);t["a"]=u.exports},4720:function(e,t,a){},"7a91":function(e,t,a){},"867b":function(e,t,a){"use strict";var i=a("7a91"),n=a.n(i);n.a},beb7:function(e,t,a){"use strict";var i=a("4720"),n=a.n(i);n.a},f652:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"merchandise-add-container"},[a("el-row",[a("el-col",{attrs:{xs:24,sm:18,md:12}},[a("merchandise-form",{ref:"form",on:{submit:e.submit}})],1)],1)],1)},n=[],r=(a("a4d3"),a("e01a"),a("b0c0"),a("d3b7"),a("e6cf"),a("a79d"),a("bc3a")),s=a.n(r),o=a("c1df"),l=a.n(o),c=a("04ed"),m={name:"MerchandiseAdd",components:{MerchandiseForm:c["a"]},methods:{submit:function(e){var t=this,a=e.name,i=e.description,n=e.integral,r=e.path;s.a.post("/api/merchandise/save",{name:a,description:i,integral:parseFloat(n),path:r,create_time:l()().format("YYYY-MM-DD")},{headers:{"Content-Type":"application/json; charset=UTF-8"}}).then((function(e){var a=e.data.code;0===a?t.$message.success("提交成功！"):t.$message.error("提交失败！")})).finally((function(){t.$refs.form.cancel()}))}}},u=m,f=(a("867b"),a("2877")),d=Object(f["a"])(u,i,n,!1,null,"4e211ffe",null);t["default"]=d.exports}}]);