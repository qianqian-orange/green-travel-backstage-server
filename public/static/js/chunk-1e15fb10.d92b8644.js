(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e15fb10"],{"04ed":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules,"label-width":"80px","status-icon":""}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{on:{blur:function(e){return t.trim("name")}},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"碳积分",prop:"integral"},on:{blur:function(e){return t.trim("integral")}}},[a("el-input",{model:{value:t.formData.integral,callback:function(e){t.$set(t.formData,"integral",e)},expression:"formData.integral"}})],1),a("el-form-item",{attrs:{label:"库存",prop:"stock"},on:{blur:function(e){return t.trim("stock")}}},[a("el-input",{model:{value:t.formData.stock,callback:function(e){t.$set(t.formData,"stock",e)},expression:"formData.stock"}})],1),a("el-form-item",{attrs:{label:"状态",required:""}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",clearable:"",maxlength:"300","show-word-limit":"",resize:"none",rows:"5"},on:{blur:function(e){return t.trim("description")}},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),a("el-form-item",{attrs:{label:"图片",required:""}},[a("el-upload",{staticClass:"upload-container",attrs:{action:"http://localhost:8080/green_travel/api/pictureUtil.action",name:"image",data:{name:"merchandise"},"show-file-list":!1,"before-upload":t.beforeUpload,"on-success":t.success,"on-error":t.error,accept:t.accept}},[t.imageUrl?a("div",{staticClass:"avatar-container"},[a("custom-image",{attrs:{url:t.imageUrl},on:{load:function(e){return t.load(t.imageUrl)}}})],1):a("div",{staticClass:"content-container"},[a("i",{staticClass:"el-icon-plus"})])])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交")]),a("el-button",{on:{click:t.reset}},[t._v("重置")])],1)],1)},n=[],r=(a("a4d3"),a("e01a"),a("b0c0"),a("a9e3"),a("e49c")),s=a("9a2e"),o=a("11f8"),l={name:"MerchandiseForm",mixins:[r["a"],s["a"]],props:{id:{type:Number,default:-1},name:{type:String,default:""},integral:{type:String,default:""},stock:{type:String,default:""},status:{type:Boolean,default:!0},description:{type:String,default:""},path:{type:String,default:""}},data:function(){return{formData:{name:"",description:"",integral:"",stock:"",status:!0},rules:{name:[{required:!0,message:"不能为空",whitespace:!0}],integral:[{required:!0,message:"不能为空"},{pattern:/(^[1-9][0-9]{0,4}(\.[0-9]{1,2})?$)|(^0?\.[0-9]{1,2}$)/,message:"不符合要求"}],stock:[{required:!0,message:"不能为空"},{pattern:/^(0|[1-9][0-9]{0,4})$/,message:"不符合要求"}],description:[{required:!0,message:"不能为空",whitespace:!0}]},loading:!1,maxUploadCount:1}},components:{CustomImage:o["a"]},watch:{id:function(){this.init()}},computed:{imageUrl:function(){return this.fileList[0].imageUrl}},created:function(){this.init()},methods:{init:function(){if(-1===this.id)return this.formData.status=!0,void(this.fileList=[{imageUrl:"",path:""}]);this.formData.name=this.name,this.formData.description=this.description,this.formData.integral=this.integral,this.formData.status=this.status,this.formData.stock=this.stock,this.fileList=[{path:this.path,imageUrl:this.path}]},cancel:function(){this.loading=!1},submit:function(){var t=this;""!==this.fileList[0].path?this.$refs.form.validate((function(e){e&&!t.loading&&(t.loading=!0,t.$emit("submit",{name:t.formData.name,description:t.formData.description,status:t.formData.status?1:0,stock:parseInt(t.formData.stock,10),integral:parseFloat(t.formData.integral),path:t.fileList[0].path}))})):this.$message.error("请选择一张图片！")},reset:function(){this.init(),-1===this.id&&this.$refs.form.resetFields()}}},c=l,u=(a("5985"),a("2877")),m=Object(u["a"])(c,i,n,!1,null,"5c507fb0",null);e["a"]=m.exports},"0e13":function(t,e,a){},"2ecd":function(t,e,a){},"32fa":function(t,e,a){},4346:function(t,e,a){"use strict";var i=a("0e13"),n=a.n(i);n.a},"454c":function(t,e,a){"use strict";var i=a("c95e"),n=a.n(i);n.a},"4f9b":function(t,e,a){},5985:function(t,e,a){"use strict";var i=a("4f9b"),n=a.n(i);n.a},"679c":function(t,e,a){"use strict";var i=a("32fa"),n=a.n(i);n.a},"9ebd":function(t,e,a){"use strict";var i=a("a4fd"),n=a.n(i);n.a},a4fd:function(t,e,a){t.exports={menuText:"#bfcbd9",menuActiveText:"#f4f4f5",menuBg:"#304156"}},bb7d:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"merchandise-list-container"},[a("div",{staticClass:"header"},[a("merchandise-search",{on:{submit:t.search}}),a("el-button",{attrs:{type:"danger",size:"medium",disabled:t.disabled||0===t.list.length},on:{click:function(e){return t.openDialog(t.batchDelete)}}},[t._v("批量删除")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.list},on:{"selection-change":t.select}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{attrs:{"label-width":"60px","label-position":"left"}},[a("el-form-item",{attrs:{label:"名称"}},[t._v(t._s(e.row.name))]),a("el-form-item",{attrs:{label:"描述"}},[t._v(t._s(e.row.description))])],1)]}}])}),a("el-table-column",{attrs:{label:"名称",prop:"name","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"multipart-line-3"},[t._v(t._s(e.row.name))])]}}])}),a("el-table-column",{attrs:{prop:"integral",label:"积分",formatter:function(e){return t.integralFormatter(e.integral)}}}),a("el-table-column",{attrs:{prop:"stock",label:"库存"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:0===e.row.status?"danger":"success",size:"medium"}},[t._v(" "+t._s(0===e.row.status?"已下架":"已上架")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"description",label:"描述","min-width":"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"multipart-line-3"},[t._v(t._s(e.row.description))])]}}])}),a("el-table-column",{attrs:{label:"图片",width:"76px"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"avatar-container"},[a("custom-preview",{attrs:{path:t.row.path}})],1)]}}])}),a("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(a){return t.openEdit(e.row)}}},[t._v("编辑")]),a("merchandise-single-delete",{attrs:{id:e.row.id},on:{"open-dialog":t.openDialog,"single-delete":t.singleDelete}})]}}])})],1),a("transition",{attrs:{name:"fade"}},[a("merchandise-edit",{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],attrs:{target:t.target},on:{close:t.closeEdit,submit:t.submit}})],1),a("custom-pagination",{attrs:{currentPage:t.currentPage,pageSize:t.pageSize,total:t.total},on:{pageChange:t.pageChange}}),a("custom-dialog",{attrs:{visible:t.dialog},on:{close:t.closeDialog,determine:t.handler}})],1)},n=[],r=(a("a4d3"),a("e01a"),a("b0c0"),a("bc3a")),s=a.n(r),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("custom-mask",[a("div",{staticClass:"merchandise-edit-container"},[a("span",{staticClass:"icon",on:{click:t.close}},[a("i",{staticClass:"el-icon-close"})]),a("merchandise-form",{ref:"form",attrs:{id:t.target.id,name:t.target.name,description:t.target.description,integral:""+t.target.integral,status:!!t.target.status,stock:""+t.target.stock,path:t.target.path},on:{submit:t.submit}})],1)])},l=[],c=(a("4de4"),a("4160"),a("e439"),a("dbb4"),a("b64b"),a("d3b7"),a("e6cf"),a("a79d"),a("159b"),a("ade3")),u=a("04ed"),m=a("1f69"),d=a("cf45");function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var h={name:"MerchandiseEdit",props:{target:{type:Object,default:function(){return{}}}},components:{MerchandiseForm:u["a"],CustomMask:m["a"]},methods:{submit:function(t){var e=this;if(Object(d["b"])(t,this.target))return this.$refs.form.cancel(),this.$message.success("提交成功！"),void this.$emit("submit",t);s.a.post("/api/merchandise/edit",p({id:this.target.id},t),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then((function(a){var i=a.data.code;if(0===i)return e.$emit("submit",t),void e.$message.success("提交成功！");e.$message.error("提交失败！")})).finally((function(){e.$refs.form.cancel()}))},close:function(){this.$emit("close")}}},g=h,b=(a("4346"),a("454c"),a("2877")),v=Object(b["a"])(g,o,l,!1,null,"fb6600dc",null),D=v.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{inline:!0,model:t.formData},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"商品名称"},on:{input:t.input},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)],1)},w=[],y=(a("498a"),a("e49c")),$={name:"MerchandiseSearch",mixins:[y["a"]],data:function(){var t=this;return{formData:{name:""},input:Object(d["a"])((function(){t.trim("name"),t.submit()}))}},methods:{submit:function(){this.$emit("submit",{name:this.formData.name})}}},_=$,x=(a("e54c"),Object(b["a"])(_,k,w,!1,null,"44d8a634",null)),O=x.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-button",{attrs:{type:"danger",size:"medium",loading:t.loading,disabled:t.loading},on:{click:t.openDialog}},[t._v("删除")])},j=[],S=(a("a9e3"),{name:"MerchandiseSingleDelete",props:{id:{type:Number,required:!0}},data:function(){return{loading:!1}},methods:{openDialog:function(){this.$emit("open-dialog",this.singleDelete)},singleDelete:function(){var t=this;return this.loading?Promise.resolve():(this.loading=!0,s.a.post("/api/merchandise/delete",{ids:[this.id]}).then((function(e){0===e.data.code?(t.$message.success("删除成功！"),t.$emit("single-delete")):t.$message.error("删除失败！")})).finally((function(){t.loading=!1})))}}}),P=S,E=Object(b["a"])(P,C,j,!1,null,null,null),U=E.exports,M=a("7621"),z=a("dfc6"),q=a("daef"),F=a("a9b3"),L=a("55c3"),T={name:"MerchandiseList",mixins:[L["a"]],data:function(){return{character:"merchandise",url:{data:"/api/merchandise/list",total:"/api/merchandise/total"},condition:{name:""},currentPage:1,pageSize:6,handler:function(){}}},components:{MerchandiseEdit:D,MerchandiseSearch:O,MerchandiseSingleDelete:U,CustomPreview:M["a"],CustomPagination:z["a"],CustomDialog:q["a"]},methods:{batchDelete:function(){var t=this;return s.a.post("/api/merchandise/delete",{ids:this.ids}).then((function(e){var a=e.data.code;0===a?(t.$message.success("删除成功！"),1!==t.currentPage&&t.currentPage===t.pageCount&&t.ids.length===t.list.length&&(t.currentPage-=1),t.total-=t.ids.length,t.core(),t.ids=[]):t.$message.error("删除失败！")}))},submit:function(t){var e=t.name,a=t.description,i=t.integral,n=t.status,r=t.path,s=t.stock;this.target.name=e,this.target.description=a,this.target.integral=i,this.target.status=n,this.target.stock=s,this.target.path=r,this.closeEdit()},search:function(t){var e=t.name;this.condition.name=e,this.currentPage=1,F["a"].set(this.character,{}),this.getData(),this.getTotal()}},beforeDestroy:function(){var t=this.condition.name;""!==t&&F["a"].set(this.character,{})}},N=T,B=(a("679c"),a("9ebd"),Object(b["a"])(N,i,n,!1,null,"5a174175",null));e["default"]=B.exports},c95e:function(t,e,a){},e54c:function(t,e,a){"use strict";var i=a("2ecd"),n=a.n(i);n.a}}]);